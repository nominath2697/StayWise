<!DOCTYPE html>
<html>
<head>
    <title>Predict | StayWise</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="{{ url_for('static', filename='assets/style.css') }}">
</head>
<body>

<div class="navbar">
    <div class="logo">StayWise</div>
    <div class="nav-links">
        <a href="/home">Home</a>
        <a href="/about">About</a>
        <a href="/predict-page">Predict</a>
        <a href="/support">Support</a>
        <a href="/">Logout</a>
    </div>
</div>

<div class="main-container">

    <div style="display:flex;flex-wrap:wrap;gap:40px;align-items:center;">

        <!-- LEFT SIDE INFO -->
        <div style="flex:1;min-width:300px;">

            <h1 style="font-size:38px;margin-bottom:20px;">
                Customer Churn Analysis
            </h1>

            <p style="color:#555;margin-bottom:30px;">
                Enter customer information to calculate churn probability 
                using trained machine learning model.
            </p>

            <img src="https://cdn-icons-png.flaticon.com/512/4321/4321090.png" width="300">

        </div>

        <!-- RIGHT SIDE FORM -->
        <div style="flex:1;min-width:350px;">

            <div class="glass-card">

                <h2 style="margin-bottom:20px;">Customer Details</h2>

                <form onsubmit="return handlePrediction(event)">

                    <div class="form-group">
                        <label>Tenure (Months)</label>
                        <input type="number" id="tenure" required>
                    </div>

                    <div class="form-group">
                        <label>Monthly Charges</label>
                        <input type="number" id="monthlyCharges" required>
                    </div>

                    <div class="form-group">
                        <label>Total Charges</label>
                        <input type="number" id="totalCharges" required>
                    </div>

                    <div class="form-group">
                        <label>Tech Support</label>
                        <select id="techSupport" required>
                            <option value="">Select</option>
                            <option value="1">Yes</option>
                            <option value="0">No</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>Contract Type</label>
                        <select id="contractType" required>
                            <option value="">Select</option>
                            <option value="month">Month</option>
                            <option value="one">One Year</option>
                            <option value="two">Two Year</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>Fiber Internet</label>
                        <select id="fiberInternet" required>
                            <option value="">Select</option>
                            <option value="1">Yes</option>
                            <option value="0">No</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>Payment Method</label>
                        <select id="paymentMethod" required>
                            <option value="">Select</option>
                            <option value="electronic">Electronic</option>
                            <option value="credit">Credit</option>
                        </select>
                    </div>

                    <button class="btn-primary" style="width:100%;margin-top:15px;">
                        Predict Now
                    </button>

                </form>

            </div>

        </div>

    </div>

</div>

<script>
async function handlePrediction(e){
    e.preventDefault();

    const data = {
        tenure: document.getElementById("tenure").value,
        monthlyCharges: document.getElementById("monthlyCharges").value,
        totalCharges: document.getElementById("totalCharges").value,
        techSupport: document.getElementById("techSupport").value,
        contract: document.getElementById("contractType").value,
        fiberInternet: document.getElementById("fiberInternet").value,
        payment: document.getElementById("paymentMethod").value
    };

    const response = await fetch("/predict", {
        method: "POST",
        headers: {"Content-Type": "application/json"},
        body: JSON.stringify(data)
    });

    const result = await response.json();

    sessionStorage.setItem("predictionScore", result.probability / 100);
    window.location.href = "/result";
}
</script>

</body>
</html>
